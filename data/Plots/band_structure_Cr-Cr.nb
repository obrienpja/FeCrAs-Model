(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     97819,       2587]
NotebookOptionsPosition[     96862,       2552]
NotebookOutlinePosition[     97231,       2568]
CellTagsIndexPosition[     97188,       2565]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "6.0675"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c", "=", "3.6570"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"primvecs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"a", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], ",", 
        FractionBox[
         SqrtBox["3"], "2"], ",", "0"}], "}"}]}], ",", 
     RowBox[{"c", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reciprocalVectors", "[", "primitiveVectors_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a1", "=", 
     RowBox[{"primitiveVectors", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a2", "=", 
     RowBox[{"primitiveVectors", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a3", "=", 
     RowBox[{"primitiveVectors", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"2", "\[Pi]", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"Cross", "[", 
         RowBox[{"a2", ",", "a3"}], "]"}], 
        RowBox[{"a1", ".", 
         RowBox[{"Cross", "[", 
          RowBox[{"a2", ",", "a3"}], "]"}]}]], ",", 
       FractionBox[
        RowBox[{"Cross", "[", 
         RowBox[{"a3", ",", "a1"}], "]"}], 
        RowBox[{"a2", ".", 
         RowBox[{"Cross", "[", 
          RowBox[{"a3", ",", "a1"}], "]"}]}]], ",", 
       FractionBox[
        RowBox[{"Cross", "[", 
         RowBox[{"a1", ",", "a2"}], "]"}], 
        RowBox[{"a3", ".", 
         RowBox[{"Cross", "[", 
          RowBox[{"a1", ",", "a2"}], "]"}]}]]}], "}"}]}]}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recVectors", "=", 
    RowBox[{"reciprocalVectors", "@", "primvecs"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kvec", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tz", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tPerp", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tzp", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2p", "=", "1.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hamiltonian", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "tz"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"primvecs", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]], ",", "0", ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"primvecs", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"primvecs", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}]], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{
            RowBox[{"kvec", "[", 
             RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
            RowBox[{"primvecs", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]], ",", "0"}], "}"}]}], 
      "}"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hamiltonian2", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "tPerp", ",", "tPerp", ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"tPerp", ",", "0", ",", "tPerp", ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"tPerp", ",", "tPerp", ",", "0", ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", "0", ",", "tPerp", 
         ",", "tPerp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", "tPerp", ",", "0", 
         ",", "tPerp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", "tPerp", ",", 
         "tPerp", ",", "0"}], "}"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hamiltonian3", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", "0", ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]]}], ",", "0", ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "-", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", "0", ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", "0", ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"t2p", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
         RowBox[{"tzp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"primvecs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"tPerp", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{
             RowBox[{"kvec", "[", 
              RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]]}], ",", "0"}], 
        "}"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"point1", "=", 
   RowBox[{".5", 
    RowBox[{"recVectors", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"point2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{".25", 
      RowBox[{"Norm", "@", 
       RowBox[{"recVectors", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{".5", 
      RowBox[{"Norm", "@", 
       RowBox[{"recVectors", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nPoints", "=", "100"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kPath", "[", "t_", "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"point1", " ", "t"}], ",", 
       RowBox[{"0", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "1"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"point2", "-", "point1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "1"}], ")"}]}], "+", "point1"}], ",", 
       RowBox[{"1", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "2"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"origin", "-", "point2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "2"}], ")"}]}], "+", 
        RowBox[{"(", "point2", ")"}]}], ",", 
       RowBox[{"2", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "3"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["\[Pi]", 
         RowBox[{"2", "c"}]], 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
        RowBox[{"(", 
         RowBox[{"t", "-", "3"}], ")"}]}], ",", 
       RowBox[{"3", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "4"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"point1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "4"}], ")"}]}], "+", 
        RowBox[{
         FractionBox["\[Pi]", 
          RowBox[{"2", "c"}]], 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
       RowBox[{"4", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "5"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"point2", "-", "point1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "5"}], ")"}]}], "+", "point1", "+", 
        RowBox[{
         FractionBox["\[Pi]", 
          RowBox[{"2", "c"}]], 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
       RowBox[{"5", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "6"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"origin", "-", "point2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "6"}], ")"}]}], "+", 
        RowBox[{"(", "point2", ")"}], "+", 
        RowBox[{
         FractionBox["\[Pi]", 
          RowBox[{"2", "c"}]], 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
       RowBox[{"6", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", "7"}]}], 
      "}"}]}], "}"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kPoints", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"kPath", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "7", ",", 
       FractionBox["1", "nPoints"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamiltonians", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"hamiltonian", "[", 
      RowBox[{
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "kPoints"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamiltonians2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"hamiltonian2", "[", 
      RowBox[{
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "kPoints"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamiltonians3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"hamiltonian3", "[", 
      RowBox[{
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "kPoints"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigs", "=", 
   RowBox[{"Sort", "/@", 
    RowBox[{
     RowBox[{"Chop", "@", "Eigenvalues"}], "/@", "hamiltonians"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigs2", "=", 
   RowBox[{"Sort", "/@", 
    RowBox[{
     RowBox[{"Chop", "@", "Eigenvalues"}], "/@", "hamiltonians2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eigs3", "=", 
    RowBox[{"Sort", "/@", 
     RowBox[{
      RowBox[{"Chop", "@", "Eigenvalues"}], "/@", "hamiltonians3"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", "eigs"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", "eigs2"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", "eigs3"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.629562061723072*^9, 3.629562077424061*^9}, {
   3.6295621311003065`*^9, 3.629562132673808*^9}, {3.6296997033213673`*^9, 
   3.6296997557053795`*^9}, {3.6296998180078635`*^9, 
   3.6296998291494904`*^9}, {3.629699895311651*^9, 3.6296999350686097`*^9}, {
   3.629699981734173*^9, 3.6296999902973638`*^9}, {3.629700058975916*^9, 
   3.6297000927872124`*^9}, {3.629701586448225*^9, 3.6297016329986677`*^9}, {
   3.6297021241325617`*^9, 3.6297021724046474`*^9}, {3.629710353469261*^9, 
   3.6297103911081977`*^9}, {3.6297106750252504`*^9, 3.629710675221427*^9}, {
   3.629710750464278*^9, 3.6297107622264924`*^9}, {3.629710796207946*^9, 
   3.6297108291784325`*^9}, 3.629711809504216*^9, {3.629711859146596*^9, 
   3.629711938807638*^9}, {3.629711993441818*^9, 3.6297121279582434`*^9}, {
   3.629712170319682*^9, 3.629712182049865*^9}, {3.629712226732524*^9, 
   3.6297122724031267`*^9}, {3.6297123115665164`*^9, 
   3.6297123124613705`*^9}, {3.6297123528359437`*^9, 3.629712371467722*^9}, {
   3.62971240415493*^9, 3.629712418997082*^9}, {3.629712472515177*^9, 
   3.6297124936924105`*^9}, {3.6297125299340224`*^9, 3.629712568621932*^9}, {
   3.629712602156948*^9, 3.6297126210870414`*^9}, {3.629712939302828*^9, 
   3.629712956685422*^9}, {3.6297130510335093`*^9, 3.62971307286035*^9}, {
   3.629713138915414*^9, 3.6297132163063*^9}, {3.6297132485871058`*^9, 
   3.6297133705305276`*^9}, 3.629713559099574*^9, {3.6297138249533725`*^9, 
   3.6297138289411974`*^9}, 3.6297139532648997`*^9, {3.6297141444113636`*^9, 
   3.629714164662698*^9}, {3.629714290642975*^9, 3.629714298224223*^9}, 
   3.630812231713985*^9, {3.63081228434443*^9, 3.630812286893661*^9}, {
   3.630890863575313*^9, 3.6308908811062603`*^9}, {3.630904842679294*^9, 
   3.630904877805395*^9}, {3.6309049097005873`*^9, 3.630904914754263*^9}, {
   3.630905016273675*^9, 3.630905023289513*^9}, 3.630905079943768*^9, {
   3.63090514798463*^9, 3.630905148377326*^9}, {3.6309051934849453`*^9, 
   3.6309051940555487`*^9}, 3.6309052358490562`*^9, {3.630945867606978*^9, 
   3.630945870340075*^9}, {3.630947445129746*^9, 3.63094747363209*^9}, {
   3.631213459483047*^9, 3.631213530978992*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"g1", ",", "g2", ",", "g3", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", " ", 
    "\"\<Band structure for simple 'hybrid' orbital model of FeCrAs\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.630890891010313*^9, 3.630890983056602*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011111111111111112`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd1ElKA3EQxeGnK5cuXLhwEUVERMR5Nvkb51lj0pmMRsG1V6gLeIfcxDqK
R/ACjnRA6tcQmq9fvVQnJD3+9FJ5HpT0+vv6O+fHR+k7P976F1L0UOpf9/w0
jHwEHsX8GFyAJ9CfTF/BU5ifxvwM5mfhOfTn4QV4Ee+/lAZCvoz5Fcyvps/g
NXgd/Q14E97C/m14B/NFuASnaIO1ixxWGXkZ97OHHNY+clgHyGEdIod1hBzW
MXJYJ8hhnSKHdYYc1jlyWBfIYV0ih3UVf48G6zo6wQY7rBv0YYMdVgV92GCH
dYs+bLDDqqIPG+xVfL819GGrxXmHlUWnDP0sPr8c86pjfz3OG+x19BvYD1sD
n7+B/3cT/Sbuvxmfdw6rhT5ssLewvx2d2ujDDusO+2GDHVYH/U68H0PusO7R
hw12WA/owwY7rG50AU5wFza4Bzv8DusR++EEd2GDe//+AeF2GGA=
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.011111111111111112`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd1ElOAlEQxvHSlUsXLly4QGOMMcY4z0oJOM9I0w0Ioolrr1AX8A4cpY7i
DXTriBJNTP07IZ1fvlev6z369ejdQ/m+X0Qef369++/1ko930a9u73r+84B+
BA/qZ/CQxvphfQv5iHaDc5h/TPtC/Tg8gfGTyKcw/zT6m0H9LPqb0/fgeaxn
AfMtYj+WMH4Z/a0gX0W+hnwd+Qb638T4Lax/G3ke69M4v8GygxyWQtwPK+hr
mL8Yn2dF7Fcp9msl9LsbbbDsIYdlHzksB8hhOUQOyxFyWI6Rw3KCHJZT5LCc
IYflHDksF9EKG+ywXKIeNthhKaMeNthhuUI9bLDDUkE9bJV43ryC9zeJ778m
qE/i98UTnM9qnF+rOG+wY7ykMdcU5ymN/XmK+iz2pxnOa4b9y/D9q8X90BrW
X0P/yKWO/uuoR+519N+I47WB9SP3Br5/13g+bLDD0sT/34zfP2vG53kT708r
9qstrB92WG6wfthgh6UdnYMVbsMGd2CHn2C5xfNhhduwwZ1/fwO0myJt
       "]]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
      0.011111111111111112`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd1ElKQ1EQheFjnDh04MCBgygiIiL2vabU2Pcx3UtnFBy7hbsB95Cl1FLc
ga7APiD1Pwjhy7mHW7l5eeOPz6WnnKSX79fP+9/1Xsj13/sfWPSQDQQP2+fv
9db3CNaPwmPo503BE1g/aYPBU8in4Rl4Fp7DfvPIF+wjfJ9F5EuYfxn5CuZd
hdew/zr6G8g3sd8WvI31O8h34QJscb5kmGcvrk+w9uP6BOsgnmeCVUS/iPM6
xHywjpDDOkYO6wQ5rFPksM6QwzpHDusCOaxL5LCukMO6xvnCuok2OMEO6xZ9
OMEOq4Q+nGCHdYc+nGCHVUYfTrCXcf9X4vPPKujDXkG/agr7V9Gvxt/TkauG
+eEEey3upzr6dfxfkXsd82foZ7gfYc+wfwP9RsxTI+7nsJpxvTXxvIIdVivO
Zy2cXwt9WG3MD6d2PE+H1UG/g/ODHdY95ocT7LC60XnY4C6c4B7s8CusB+wP
G9yFE9z79xfTeky4
       "]]}}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdzklOAlEUheEjOnDowIEDB2iUGGOMfa9c+16gwL5DE8du4W7APbCUuxSX
4AYURUnk/ZWQysdfp14NPb9mLzlJbz+/1v3v+ih2/d4L0f7DUvfCfXA/PAAP
wnl4GB6BC/AYPA5PwJPwFDwNz8Cz8Bw8Dy/Ai/ASvAyvwKvwGrwOb8BF2FI7
rE10WFvosLbRYe2gw9pFh7WHDmsfHdYBOqxDdFhH6LCO0WGdoMM6RYd1hg6r
ZN1JL9lns3WNtnvZmp22sil5vmy5TgeeVwX7Cr4Hjkr6fmXW02nLcH6Wvj9g
VXF+1b467egBq5aeZzV8PxywzlMb7HDAusAedjhgXWIPOxywrrCHHQ5Y19jD
DgesG+xhhwPWLfawwwHrDnvY4YB1jz3scMB6wB52OGA9Yg87HLDqqfOwwXXY
4QYc8DusJ5wPG1yHHW78+xsw0i/p
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd0LlKQ1EUheFFELG0sLCwiCIiIuI8a7bzbEbnKQrWvsJ+Ad8hb+J+FEsL
wRQWFoIaEjDnv3A5fHeddc7m9j88lR4zkp7/3sbafOq5+k/j+XhpfbDUXXA3
3AP3wn1wFh6AB+EheBgegUfhMXgcnoAn4Sl4Gp6BZ+E5eB5egBfhJXgZXoFX
4RxsqR3WGnJY68hhbSCHtYkc1hZyWNvIYe0gh7WLHNYeclj7yGEdIId1iBzW
EXJYx8hh5a251lt53jrarYJ9te+3gmWS/QX7bM8DuYrpeVa072SeYjpPFNN5
VLK35P5Sep7DUcL9ZXtP+uV0Xi+n80QZ91esM5m/kv4Pr2B+WCepDXY4YJ2i
DzscsM7Qhx0OWOfoww4HrAv0YYcD1iX6sMMB6wp92OGAdY0+7HDAukEfdjhg
3aIPOxyw7tCHHQ5Y1dRZ2OAq7HANDvgV1j3uhw2uwg7X/v0LLaxjow==
       "]]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdzklOVVEUBdAt2rBpg4YNG2iIMcYYFUssuBaICgr+jzXK18Q2UzgTYA4M
5Q7FIdg3lvATfOsmLzfr7bffOae/7Iy+ziTZ/fv8uw/O96Xf++dom75oQx/H
J/AsPolP4Tl8Bs/js/gcPo8v4Iv4Er6Mr+AFfBVfw9fxDXwT38KL+Da+g+/i
e3gJt6EL5z45zgNynIfkOI/IcZbJcR6T46yQ4zwhx3lKjvOMHGeVHGeNHOc5
Oc4Lcpz1dmT/PjbN19vM/87G9J66bbRfg//hzvd5OZzXcOGOM6KPC/cR+4/Z
H9e4/Rj0x+3nYP4mfVybzMd5xf64cMd5TR8X7jhv6OPCHectfVy447yjjwt3
nPf0ceGO84E+Ltxxtujjwh3nI31cuON8oo8Ld5xt+rhwx5kMPYcbnuDCe7jj
bzifmY8bnuDCe4f+A61HrvI=
       "]]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd0EtqFUEYBeCjhODQQQYOHEQRERHxETU+U77f8ebexPfjRnCcLdQG3EOW
8i8lS8gSVHJB6mtour4+/6Gq+8zPvemv40l+/73/PY+uw42j9VJbvGijT+CT
eAWfwqfxKj6Lz+Hz+AK+iC/hy/gKvoqv4et4Dd/AN/EtvI5v4zv4Lr6H7+MH
eAO30R3nITnOI3Kcx+Q4T8hxnpLjPCPHeU6O84Ic5yU5zitynNfkOG/Icd6S
42yS47xrS0OOMxndJu3YMD9ZzC1czGdr3K9tjfMdF/OZjnmbct7pOF84s/G8
bcb/wDUb98t2Wx762/Rx4ezw/bjjwnlPH3dcOB/o444L5yN93HHhfKKPOy6c
z/Rxx4XzhT7uuHC+0scdF843+rjjwvlOH3dcOD/o444LZz56FTc8xx3v48IH
OLvsjxue4473//sPbAObgA==
       "]]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd0ElKA1EUheGjIgg6cODAgYMoIiIi9r3m2vcmlYp9VwqO3cLdgHvIUt5S
XIJju2hIgXl/QUi+/O+kkgw+vVSe2yW9/j0az83rvdh83WP5Gxa7C+6F++B+
eAAuwEPwMDwCj8Jj8Dg8AU/CU/A0PAPPwnPwPLwAL8JL8DK8Aq/Ca/A6XIQt
tsPaQIe1iQ5rCx3WNjqsHXRYu+iw9tBh7aPDOkCHdYgO6wgd1jE6rBN0WKfo
sErWFvWSfdYbV3fey1ZvtZVxHj2gK7HOVlsSn/fEvqJ9Yh3RvmI/0f1hr+Tn
8vMBXWn8ey3FPrXv6P4pvn81/j+sah/Rvhp/foB1hvvDDgdY59jDDgdYF9jD
DgdYl9jDDgdYV9jDDgdY19jDDgdYN9jDDgdYt9jDDgdYd9jDDgdY99jDDgdY
D9jDDgdYWewCbHAGO1yDA/wG6xH3hw3OYIdr//4FGqfnYg==
       "]]}, 
     {RGBColor[0.772079, 0.431554, 0.102387], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd0EdKg1EUhuHPKGLJwIEDBw6iiIiI2Lvm2Lup9hYFx27hbMA9ZCl3KS7B
HViSiJ73h/Dz/O/9uJCh59fyS0bS2/fv5918PvI9jXfWWh8sugvug/vhAXgQ
zsHD8Ag8Co/B4/AEPAlPwdPwDDwLz8Hz8AK8CC/By/AKvAqvwevwBpyHLdph
baLD2kKHtY0Oawcd1i46rD10WPvosA7QYR2iwzpCh3WMDusEHdYpOqwzdFgF
6wy90Pr+24v22Xh6m7YizqOnomXCvmTZ/7ZS7F6K96WStYd9GfeX43kvx/MJ
ViXeZxVrC/uKdYR9xbrDvor7q9hX4/+ZYJ1HG+xwgnWBPexwgnWJPexwgnWF
PexwgnWNPexwgnWDPexwgnWLPexwgnWHPexwgnWPPexwgvWAPexwgvWIPexw
glWLzsEG12CH63CC32E94X7Y4BrscP3PX275u6A=
       "]]}}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlElOA0EMRT+BBUsWLFiwCAgihBBiniEmhHnIPA8EJNZcoS7AHXKUOgpH
4AKMIRL4tRS1Xr797ba7a+bxufiUkPTy/fu5/15v6ZHBPRWHf9jn4Jof8ri9
O56whIufNJ8/hfxpG3V60uR4Fn5z8EshfwHxi9CXkL+Mflbsw/Eq4tegr6Pf
DcxjE/5byN9G/g763wXv4Xn2kX+Afg+hH8EvDT/zejD4HUMHK+P9QgbPf+L7
CWBl4Z9F/VPPAawz6GCdQwfrAjpYl9DBuoIO1jV0sG6gg3ULHaw76GDlsJ8c
3te835flTS4+7/cTEa8C8gvoBxwL3l9FG/vPVkT9ovePYJVQv+S/twA9glX2
9ayM/st+XhG6Kp6t4v1DxftHsKqoX8W+wLGK+jXUr3m/UMPzI1511K+jf+ix
jvyGn481MD9wbOD8aXq2JvKhxyb21/L7thb6b6E+dLXx/rQxf+ixjfOvg/wO
zrOOydVHvLrI76I+OIJ1j/mBAziC1fOcBBu4Bw7gPjiCX8F6QH2wgXvgAO7/
8ReUOr9d
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlLlKQ1EQhgcRsbSwsLCIIiIi4r5rJhr3LfsejYK1r3BewHfIm3gexMLC
wkIwhYWFoAYD8n8XQvjuf2Y9M3fs9j5312dmD7+/7v/f00l2vrvP+2Pvhffe
93jQ30Qf8g/hYVf7Ee8T+1HoCe8Xfdw/RZ+A/0noU/4qPO0D4m8G/mfhbw7n
5+F/wb+EFxFvCfoy7FfQv1WcX0M/15HfBvRN+NuCv23Y74CTOO/qLzj0lNYT
UvC3qxzAtudPou9BT/uL6GnE31cOYDuADrZD6GA7gg62Y+hgO4EOtlPoYDuD
DrZz6GC7gA62S9zvJfYho/frGd3XkNH7itAtq/48i3yyuu8xq/lYTvfJc+ov
gGMO8fO6H57HPOY1n5hH/ILuvxcw7wWNFws6r1aEfVHrDeBYxPyX/FnyLyF+
SeuLJdxvWevxMvpf9kHJv4zvSUXz8Qruv4L4FcSv4v6rqL+q9cQq7GvaTweH
GvpfQ//qmN864td1viJ0a6B/DT0fGpgf6NZU3ZuI30T+TY1nV3rewQEcwXYN
e3AAR7C1lBNgB7fAAdwGR/Az2G4QH+zgFjiA2//8A7CO9NI=
       "]]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlEdOA0EQRQvDgiULFixYGIQQQgiRM7gcyMHG9gSHMQaJNVfoC3AHH6WP
whFYkpMZhOqNZLWef1f6PT0TN3fV24yI3H//ftbf5zH32X8GNf1D3wwP64fh
EX0yPAp9TF8Nj0PP6rvhSR3or0MpT2H/NHgG8bNq+59L179884hfgL4IXkK+
ZcSvQF9F/Jq+GH0dfm4g3yb82sL+bdTbAe8i3x78zEFXy06xPw89D78Lll0B
8xZt/66I/CXElzDPvmUHlgPoYDmEDpYj6GA5hg6WE+hgOYUOljPoYDmHDpYL
6GApW79dWTPG/0q6pqwVnDfYY79c2noKdmAPliriwQ7sq+i/hv7Brmbvk6/h
/a0jHuzqqF/HfQwQH+iz6T+AfwHe/9DeFw0xf2jn9aHNL5HtRyM7r4vQf4T6
MfqPcf6x9cvHOL8Gzq8B/6D7Buo3Ed+Ef02734OlhfnBrmX78S3037b5tI3v
EXTfxvc5sX5pAv8T+Jeg/w7m76B/sAfLFeYHO7AHS9dyFqzgLtiBe2APfgDL
NeqDFdwFO3Dvn78AUZsw4Q==
       "]]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdk0lOw0AQRQsSEEsWLFiwCAghhBBiniGVEOYpcZw48RACEmuu0BfgDjlK
H4UjcALGGKF6liL75f9yfVd3zz69BM+jIvL6/fu5D6/38vC5qPkfOmJ4Qj9/
r0LOk9CnwNPwz2jR6CXoc9DnwQtaMLyoNu8SeBn+FeiryLsGfR36BvJuwr+F
vNvw7+T3P30X+fbQbx/1B6g/RP8j6MfIUwarrXdgqdh8roJ8Vcuuiv4nqAdL
zeZxNeinqAfLGXSwnEMHywV0sFxCB8sVdLBcQwfLDXSw3EIHyx10sNxjvmCp
W9Y61rOe+3L28EvD7hdtWL8De/glsLoGyBtYvwdL0+bVJvYz2DdtPwl13NSH
qAf7UD/MeWzh+8GuZc+vb2F+bfs+baO+bf0efonQP7L9XKRjpj5C/w7Wv2Pn
46B76NJF/y7Wr2vXx4MlxvrFdj1cjPnHyJ8gf4L5QfcJ+qf2vGiK708xP7Bk
1q8Z5p+hf4b927Pv0x7ygz1YHjB/sAN7sPQtl8AK7oMdeAD24DewPKI/WMF9
sAMP/vkLQs3jQw==
       "]]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlEdKBFEQhktFEHThwoULFyoiIiLmHGrGnJ2cdRRce4V3Ae/gUd5RPII7
c8QW/b+Gpufrv6pepZ6By+vsVauZ3Xzd38+f637953eXJy+S5y93+OvH99WZ
cDf0Hm8R7oV9n38I98N/0N9FH0K8Yegj4FHwGPzH/UX0CX8SnvQ2sZ9CvGnw
DOLPwn8O8edR74K/ib6I+Evo17LrfFbgvwr7Nejr8He1D2BLaX0hhXmm/UH8
0zhvQ+sJYNtU+7Dpj6JvKQewbUMH2w50sO1CB9sedLDtQwfbAXSwHUIH2xF0
sB1DB9sJ5neC/T/Vefsp7KFH6Jbx9v/sGexTRvclZvB9ZHUfHByyiV1iH6Fb
TvfZc/DP6X7FHPLPaz8878/in1f7mMf5BfgXtN4APRa0Hiui/iL6X0T+Rc3P
SspewvdUQv4lnF9WdnAoa36xjP5VsD8VnUeoaLwIe6tqvl5F/6FHsNWQfw31
Q481nF9H/nXsTx3+ddTfQP4NnXdooH8N/b+0M+R/Bn9wBNs59g8cwBFsTeV+
sIOb4AC+BUfwHdgucD7YwU1wAN/+8Se+ZQrd
       "]]}, 
     {RGBColor[0.772079, 0.431554, 0.102387], PointSize[0.008333333333333333],
       AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlEdOA0EQRQuTw4IFCxYsACGEEELkHMrk7IizwSCx5gp9Ae7AUfooHIEL
kAxG8N9IVuv5d9Wvmq7psfvH7EPCzJ6+fs3153nd7fteB7z1h3cK9/jbR/Pp
b/Ggt4s+5Anh4db6yyPIN4r4cW8TnkC+Se8WnsL+aeSfAc9i/xzqm/cO4QXo
i/4h/S8h/zJ4BfGr0NfQ/zrq24C+ifgt6Nvw20G+XbxP1/jg3it60rtET/q7
9L+nHPZQz776hX3UdwD/A+iHygFsR9DBdgwdbCfQwXYKHWxn0MF2Dh1sF9DB
dgkdbFfQwZbC+aWgp3WePY390GMa85Pxgf/sGZx3Rv1iBvORhX8W/WR1fwRb
Tv08p/Mecvo9xxzmOw//POLz8M/jfrjW/X6teoAewVbQfr2A+IL2Fwvovwj/
ouYLRb0vYhHxJe+R+JLuDyXNF0s6H1ZG/WV8z2XUX0b/FcRXMD8VrS9WcP9W
1c+rOD9wrOL+rGk/XlO/UMP81PD+6vCvaz+hDn/odoP5vUH94Ai2W5w/OIAj
2BrKo2AHN8AB/AyO4Bew3cEf7OAGOICf//gTHN3VrQ==
       "]]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotLabel->FormBox[
   "\"Band structure for simple 'hybrid' orbital model of FeCrAs\"", 
    TraditionalForm],
  PlotRange->All,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.63089089772484*^9, 3.630890908427594*^9}, 
   3.630890984028616*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.630812401242724*^9, 3.630812427091415*^9}, {
   3.630812573051174*^9, 3.630812604683363*^9}, {3.630812651122924*^9, 
   3.630812693812071*^9}, {3.630812725567071*^9, 3.630812831676805*^9}, {
   3.630812865229062*^9, 3.630812887692045*^9}, {3.630813920434938*^9, 
   3.630813921094166*^9}, {3.63081395564324*^9, 3.63081395716285*^9}, {
   3.630906729643096*^9, 3.6309067608608913`*^9}, 3.630906804023776*^9, 
   3.630907111129064*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"errorsOff", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"NIntegrate", "::", "slwcon"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Off", "[", 
     RowBox[{"NIntegrate", "::", "eincr"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Off", "[", 
     RowBox[{"NIntegrate", "::", "oidiv"}], "]"}], ";"}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"errorsOff", "[", "]"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"a0", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"n_", ",", "r_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", "r"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"n", " ", "a0"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]nlm", "[", 
   RowBox[{
   "n_", ",", "l_", ",", "m_", ",", "r_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
   "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", 
       RowBox[{"(", 
        RowBox[{"n", " ", "a0"}], ")"}]}], ")"}], "^", "3"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "l", "-", "1"}], ")"}], "!"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "n", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "l"}], ")"}], "!"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"E", "^", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Rho]", "[", 
       RowBox[{"n", ",", "r"}], "]"}]}], "/", "2"}], ")"}]}], " ", 
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"n", ",", "r"}], "]"}], "^", "l"}], " ", 
  RowBox[{"LaguerreL", "[", 
   RowBox[{
    RowBox[{"n", "-", "l", "-", "1"}], ",", 
    RowBox[{
     RowBox[{"2", " ", "l"}], "+", "1"}], ",", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"n", ",", "r"}], "]"}]}], "]"}], " ", 
  RowBox[{"SphericalHarmonicY", "[", 
   RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]nlmCart", "[", 
   RowBox[{"n_", ",", "l_", ",", "m_", ",", "x_", ",", "y_", ",", "z_"}], 
   "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", 
       RowBox[{"(", 
        RowBox[{"n", " ", "a0"}], ")"}]}], ")"}], "^", "3"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "l", "-", "1"}], ")"}], "!"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "n", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "l"}], ")"}], "!"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{"n", ",", "r"}], "]"}]}], "/", "2"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"n", ",", "r"}], "]"}], "^", "l"}], " ", 
    RowBox[{"LaguerreL", "[", 
     RowBox[{
      RowBox[{"n", "-", "l", "-", "1"}], ",", 
      RowBox[{
       RowBox[{"2", " ", "l"}], "+", "1"}], ",", 
      RowBox[{"\[Rho]", "[", 
       RowBox[{"n", ",", "r"}], "]"}]}], "]"}], " ", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"z", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}], "+", 
          RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"x", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}]}], "]"}]}], "]"}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"R1", "[", "r_", "]"}], ":=", 
  RowBox[{
   RowBox[{"2", "/", 
    RowBox[{"a0", "^", 
     RowBox[{"(", 
      RowBox[{"3", "/", "2"}], ")"}]}]}], " ", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "/", "a0"}], ")"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"R2", "[", "r_", "]"}], ":=", 
  RowBox[{
   RowBox[{"r", "/", "a0"}], " ", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "a0"}], ")"}]}], ")"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]x", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"R2", "[", "r", "]"}], " ", 
    RowBox[{"x", "/", "r"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nx", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]x", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]x", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]xNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nx", " ", 
   RowBox[{"\[Psi]x", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]y", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"R2", "[", "r", "]"}], " ", 
    RowBox[{"y", "/", "r"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Ny", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]y", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]y", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]yNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Ny", " ", 
   RowBox[{"\[Psi]y", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]z", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"R2", "[", "r", "]"}], " ", 
    RowBox[{"z", "/", "r"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Abs", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nz", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]z", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]z", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]zNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nz", " ", 
   RowBox[{"\[Psi]z", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"porbs", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Psi]xNorm", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"\[Psi]yNorm", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"\[Psi]zNorm", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Definition", " ", "of", " ", "the", " ", "1", "s", " ", "wavefunction"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]4sNorm", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Psi]nlm", "[", 
     RowBox[{
     "1", ",", "0", ",", "0", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
     "]"}], "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Definition", " ", "of", " ", "the", " ", "3", "d", " ", "wavefunctions"}],
    "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R32", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], " ", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "r"}], "/", 
       RowBox[{"(", 
        RowBox[{"3", " ", "a0"}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]xy", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", " ", "y"}], ")"}], "/", 
     RowBox[{"r", "^", "2"}]}], " ", 
    RowBox[{"R32", "[", "r", "]"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nxy", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]xy", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]xy", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]xyNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nxy", " ", 
   RowBox[{"\[Psi]xy", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]xz", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", " ", "z"}], ")"}], "/", 
     RowBox[{"r", "^", "2"}]}], " ", 
    RowBox[{"R32", "[", "r", "]"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nxz", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]xz", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]xz", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]xzNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nxz", " ", 
   RowBox[{"\[Psi]xz", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]yz", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y", " ", "z"}], ")"}], "/", 
     RowBox[{"r", "^", "2"}]}], " ", 
    RowBox[{"R32", "[", "r", "]"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nyz", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]yz", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]yz", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]yzNorm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nyz", " ", 
   RowBox[{"\[Psi]yz", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]z2", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"z", "^", "2"}]}], "-", 
       RowBox[{"r", "^", "2"}]}], ")"}], "/", 
     RowBox[{"r", "^", "2"}]}], " ", 
    RowBox[{"R32", "[", "r", "]"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nz2", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]z2", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]z2", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]z2Norm", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Nz2", " ", 
   RowBox[{"\[Psi]z2", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]x2y2", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "-", 
       RowBox[{"y", "^", "2"}]}], ")"}], "/", 
     RowBox[{"r", "^", "2"}]}], " ", 
    RowBox[{"R32", "[", "r", "]"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"Nx2y2", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]x2y2", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[Conjugate]"}], " ", 
         RowBox[{"\[Psi]x2y2", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]x2y2Norm", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Nx2y2", " ", 
    RowBox[{"\[Psi]x2y2", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]Central", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]4sNorm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"\[Psi]xyNorm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"\[Psi]xzNorm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"\[Psi]yzNorm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"\[Psi]z2Norm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"\[Psi]x2y2Norm", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyrState", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Psi]Central", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "6"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrStateb", "[", 
   RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"pyrState", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"rho", " ", 
       RowBox[{"Sin", "[", "theta", "]"}], " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}]}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"rho", " ", 
       RowBox[{"Sin", "[", "theta", "]"}], " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"rho", " ", 
       RowBox[{"Cos", "[", "theta", "]"}]}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "[", 
   RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"rho", "*", 
   RowBox[{"Sin", "[", "theta", "]"}], "*", 
   RowBox[{"Cos", "[", "phi", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"y1", "[", 
   RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"rho", "*", 
   RowBox[{"Sin", "[", "theta", "]"}], "*", 
   RowBox[{"Sin", "[", "phi", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z1", "[", 
    RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
   RowBox[{"rho", "*", 
    RowBox[{"Cos", "[", "theta", "]"}]}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Pyramid", " ", "vertices"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], ",", 
     RowBox[{"y1", "[", 
      RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], ",", 
     RowBox[{"z1", "[", 
      RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyr", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2.51559", ",", "0.", ",", "0."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.518164"}], ",", 
       RowBox[{"-", "1.75154"}], ",", 
       RowBox[{"-", "1.8285"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.518164"}], ",", 
       RowBox[{"-", "1.75154"}], ",", "1.8285"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.518164"}], ",", "1.75154", ",", 
       RowBox[{"-", "1.8285"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.518164"}], ",", "1.75154", ",", "1.8285"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "[", 
   RowBox[{"rho_", ",", "theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], "-", 
             RowBox[{"pyr", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ")"}], ")"}], "^", 
         "2"}], "+", 
        RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "pyr"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V1", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrStateb", "[", 
       RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"H1", "[", 
      RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], "*", 
     RowBox[{
      RowBox[{"pyrStateb", "[", 
       RowBox[{"rho", ",", "theta", ",", "phi"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], " ", 
     RowBox[{"rho", "^", "2"}], " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"rho", ",", "0", ",", "range"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"phi", ",", "0", ",", 
      RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6308130446119347`*^9, 3.630813093040642*^9}, {
  3.63081321783904*^9, 3.630813275652398*^9}, {3.63081332545971*^9, 
  3.630813326705205*^9}, {3.6308135667983932`*^9, 3.630813591033455*^9}, {
  3.630813649588623*^9, 3.6308137123370934`*^9}, {3.6308137445299673`*^9, 
  3.630813799531987*^9}, {3.630813878225316*^9, 3.6308138817955637`*^9}, {
  3.631132200686913*^9, 3.631132214286564*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", "l"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox["r", "n"]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["r", "n"], ")"}], "l"], " ", 
  RowBox[{"LaguerreL", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "l"}]}], ",", 
    FractionBox[
     RowBox[{"2", " ", "r"}], "n"]}], "]"}], " ", 
  RowBox[{"SphericalHarmonicY", "[", 
   RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]], "Output",
 CellChangeTimes->{3.63086414028155*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", "l"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]], "n"]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]], "n"], ")"}], "l"], " ", 
  RowBox[{"LaguerreL", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "l"}]}], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], "n"]}], "]"}], " ", 
  RowBox[{"SphericalHarmonicY", "[", 
   RowBox[{"l", ",", "m", ",", 
    RowBox[{"ArcCos", "[", 
     FractionBox["z", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]], "]"}], ",", 
    RowBox[{"ArcCos", "[", 
     FractionBox["x", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]]], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.630864140315234*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HCF", "=", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"V1", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6308130446119347`*^9, 3.630813093040642*^9}, {
  3.63081321783904*^9, 3.630813275652398*^9}, {3.63081332545971*^9, 
  3.630813326705205*^9}, {3.6308135667983932`*^9, 3.630813591033455*^9}, {
  3.630813649588623*^9, 3.6308137123370934`*^9}, {3.6308137445299673`*^9, 
  3.630813799531987*^9}, {3.630813878225316*^9, 3.6308138817955637`*^9}, {
  3.630906069077394*^9, 3.630906114271693*^9}, {3.6309061774404373`*^9, 
  3.630906194188117*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "@", "t"}]], "Input",
 CellChangeTimes->{{3.630946331831822*^9, 3.630946350633851*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pyrData", "=", 
   RowBox[{"<<", "\"\<~/Documents/pyramid/changesArray_pyramid.txt\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigs", "=", 
   RowBox[{"Chop", "@", 
    RowBox[{"Eigensystem", "@", "HCF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFS\[ScriptCapitalU]", "=", 
   RowBox[{"eigs", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyr\[ScriptCapitalU]", "=", 
   RowBox[{"construct\[ScriptCapitalU]tot", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "5", "]"}], ",", "pyrData"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.630906196843443*^9, 3.6309061972915*^9}, 
   3.630906852966505*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hamiltonianFinal", "[", 
   RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"hamiltonian2", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"hamiltonian3", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}], ",", 
        RowBox[{"hamiltonian", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}]}], "}"}]}], "}"}], "]"}],
    "+", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], 
       RowBox[{"newMat2", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hamiltoniansFinal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"hamiltonianFinal", "[", 
      RowBox[{
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"kPoints", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "kPoints"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigsFinal", "=", 
   RowBox[{"Sort", "/@", 
    RowBox[{
     RowBox[{"Chop", "@", "Eigenvalues"}], "/@", "hamiltoniansFinal"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", "eigsFinal"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Band Structure for Cr-Cr Hopping Model with Crystal Field \
Splitting\>\""}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<Energy(eV)\>\""}], "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<\[CapitalGamma]\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nPoints", ",", "\"\<M\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "nPoints"}], ",", "\"\<K\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "nPoints"}], ",", "\"\<\[CapitalGamma]\>\""}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"4", "nPoints"}], ",", "\"\<A\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"5", "nPoints"}], ",", "\"\<L\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"6", "nPoints"}], ",", "\"\<H\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"7", "nPoints"}], ",", "\"\<A\>\""}], "}"}]}], "}"}], ",",
         "All"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<~/Documents/bandStructure3.pdf\>\"", ",", "finalPlot"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.630813997266721*^9, 3.630814092413393*^9}, {
  3.630814140888667*^9, 3.630814144725816*^9}, {3.63090711947046*^9, 
  3.6309071247503643`*^9}, {3.6309071852231073`*^9, 3.630907331782633*^9}, {
  3.630907707268814*^9, 3.630907730734988*^9}, {3.630907859334251*^9, 
  3.630907999312449*^9}, {3.630908040495029*^9, 3.6309080512635937`*^9}, {
  3.630908097143198*^9, 3.6309082822251*^9}, {3.630908385672675*^9, 
  3.630908478757869*^9}, {3.6309085174470253`*^9, 3.630908575845842*^9}, {
  3.630908660132465*^9, 3.630908677336755*^9}, {3.630908736728033*^9, 
  3.6309087546451178`*^9}, {3.630945917957673*^9, 3.630945927779565*^9}, {
  3.6309472803270483`*^9, 3.6309472967209167`*^9}, {3.630947541090481*^9, 
  3.6309475460926647`*^9}, {3.630947581115817*^9, 3.630947589310315*^9}}],

Cell[BoxData["\<\"~/Documents/bandStructure3.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.630814093633095*^9, 3.630814145570459*^9, 3.63090505700114*^9, 
   3.630905087664865*^9, 3.630905156453302*^9, 3.630905202163464*^9, 
   3.63090524169529*^9, {3.630906738708967*^9, 3.630906768584063*^9}, 
   3.630906813583593*^9, 3.630907126231079*^9, {3.630907186481338*^9, 
   3.630907214423167*^9}, {3.630907287466395*^9, 3.630907297823773*^9}, 
   3.630907333344788*^9, {3.630907714601096*^9, 3.630907732073481*^9}, {
   3.630907890465558*^9, 3.630907920389173*^9}, {3.630907952483831*^9, 
   3.630908001535315*^9}, 3.63090805299436*^9, {3.630908123789155*^9, 
   3.630908173353415*^9}, {3.630908236751603*^9, 3.630908282898494*^9}, 
   3.630908390228648*^9, 3.630908439971862*^9, {3.630908544031*^9, 
   3.6309085781566057`*^9}, 3.630908679816785*^9, {3.6309087446615477`*^9, 
   3.6309087564114637`*^9}, {3.6309459215293207`*^9, 3.630945929059278*^9}, 
   3.630947314505108*^9, 3.630947375542953*^9, 3.630947506810094*^9, 
   3.6309475478184557`*^9, 3.63094759332668*^9, 3.630951025438575*^9, 
   3.630951111938108*^9, 3.6309511676547422`*^9, 3.630951278382752*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fe-Fe block of the Hamiltonian", "Section",
 CellChangeTimes->{{3.631207648700965*^9, 3.6312076758051643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hamiltonianFeFe", "[", 
   RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tzFe", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
          RowBox[{"tzFe", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
          RowBox[{"tzFep", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"primvecs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
          RowBox[{"tzFe", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}]}], "}"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tzFe", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"primvecs", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
           RowBox[{"tzFe", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}]]}], ",", 
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"primvecs", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
           RowBox[{"tzFep", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"primvecs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]]}], ",", 
           RowBox[{"tzFe", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{
               RowBox[{"kvec", "[", 
                RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
               RowBox[{"primvecs", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}]]}]}], "}"}]}], "}"}], 
       "\[ConjugateTranspose]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"tperpFe", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]], ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]], ",", "0", ",", "1"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]], ",", "1", ",", " ", "0"}],
           "}"}]}], "}"}]}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"tperpFe", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]], ",", "0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              RowBox[{"kvec", "[", 
               RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ".", 
              RowBox[{"primvecs", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]], ",", " ", "0"}], "}"}]}], 
        "}"}]}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6312076821212063`*^9, 3.631207682895277*^9}, {
  3.631207814895838*^9, 3.6312078638405313`*^9}, {3.6312078949688*^9, 
  3.631207980670162*^9}, {3.631209490865224*^9, 3.631209496226016*^9}, {
  3.6312095409725933`*^9, 3.631209545156645*^9}, {3.6312104186448717`*^9, 
  3.6312105640446377`*^9}, {3.631210923807433*^9, 3.631210932999806*^9}, {
  3.6312109651965427`*^9, 3.631211042813727*^9}, {3.631211097929446*^9, 
  3.631211152785763*^9}, {3.631211367652968*^9, 3.631211521973465*^9}, {
  3.631211703130844*^9, 3.6312118998060637`*^9}, {3.6312119612210207`*^9, 
  3.6312120513133163`*^9}},
 EmphasizeSyntaxErrors->True]
}, Open  ]]
},
WindowSize->{1680, 1023},
WindowMargins->{{Automatic, 0}, {-25, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 35332, 918, 2569, "Input"],
Cell[CellGroupData[{
Cell[35915, 942, 339, 8, 45, "Input"],
Cell[36257, 952, 10959, 205, 366, "Output"]
}, Open  ]],
Cell[47231, 1160, 482, 7, 45, "Input"],
Cell[CellGroupData[{
Cell[47738, 1171, 23755, 720, 2045, "Input"],
Cell[71496, 1893, 623, 19, 65, "Output"],
Cell[72122, 1914, 1400, 47, 172, "Output"]
}, Open  ]],
Cell[73537, 1964, 964, 23, 104, "Input"],
Cell[74504, 1989, 119, 2, 45, "Input"],
Cell[74626, 1993, 740, 20, 133, "Input"],
Cell[CellGroupData[{
Cell[75391, 2017, 5276, 138, 423, "Input"],
Cell[80670, 2157, 1161, 16, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81868, 2178, 117, 1, 100, "Section"],
Cell[81988, 2181, 14858, 368, 568, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
